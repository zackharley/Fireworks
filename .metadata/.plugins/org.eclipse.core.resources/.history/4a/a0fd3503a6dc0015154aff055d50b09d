/**
 * 
 * @author zackh_000
 * @version 1.0
 */
public class RungeKuttaSolver {

	public RungeKuttaSolver() {
		
	} // end full constructor
	
	public double[] solve(double time, double vx, double vy, double vWind, double deltaT) {
		double q1x, q2x, q3x, q4x, q1y, q2y, q3y, q4y;
		double halfTime = time + deltaT / 2;
		double fullTime = time + deltaT;
		double[] newVals = new double[2];
		// Use the apparent velocity in the differential equations, so the drag force
		// is calculated using vxa, rather than just vx.
		double vxa = vx - vWind;
		q1x = xDE(time, vxa, vy);
		q1y = yDE(time, vxa, vy);
		q2x = xDE(halfTime, vxa + deltaT * q1x / 2, vy + deltaT * q1y / 2);
		q2y = yDE(halfTime, vxa + deltaT * q1x / 2, vy + deltaT * q1y / 2);
		q3x = xDE(halfTime, vxa + deltaT * q2x / 2, vy + deltaT * q2y / 2);
		q3y = yDE(halfTime, vxa + deltaT * q2x / 2, vy + deltaT * q2y / 2);
		q4x = xDE(fullTime, vxa + deltaT * q3x, vy + deltaT * q3y);
		q4y = yDE(fullTime, vxa + deltaT * q3x, vy + deltaT * q3y);
		newVals[0] = vx + deltaT * (q1x + 2 * q2x + 2 * q3x + q4x) / 6;
		newVals[1] = vy + deltaT * (q1y + 2 * q2y + 2 * q3y + q4y) / 6;
		return newVals;
	} // end estimateVelocity
	
} // end RungeKuttaSolver
